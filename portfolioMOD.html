<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Pablo Biedma</title>
  <style>
    :root {
      --bg: #000;
      --fg: #fff;
      --glass: rgba(255,255,255,0.08);
      --glass-border: rgba(255,255,255,0.25);
    }

    body {
      background-color: var(--bg);
      color: var(--fg);
      font-family: Arial, sans-serif;
      text-align: center;
      margin: 0;
      padding: 20px;
    }

    h1 { margin: 6px 0 16px; font-size: 24px; }

    /* ---- Gallery wrapper with fades & buttons ---- */
    .gallery-wrap { position: relative; margin: 0 auto; max-width: 1400px; }

    /* Edge fades hinting sideways scroll */
    .gallery-wrap::before,
    .gallery-wrap::after {
      content: "";
      position: absolute;
      top: 0;
      bottom: 0;
      width: 48px;
      pointer-events: none;
      z-index: 5;
      transition: opacity .2s ease;
    }
    .gallery-wrap::before {
      left: 0;
      background: linear-gradient(to right, rgba(0,0,0,1), rgba(0,0,0,0));
      opacity: 0;
    }
    .gallery-wrap::after {
      right: 0;
      background: linear-gradient(to left, rgba(0,0,0,1), rgba(0,0,0,0));
      opacity: 1;
    }
    .gallery-wrap.at-start::before { opacity: 0; }
    .gallery-wrap.at-start::after  { opacity: 1; }
    .gallery-wrap.at-end::after    { opacity: 0; }
    .gallery-wrap.at-middle::before,
    .gallery-wrap.at-middle::after { opacity: 1; }

    /* ---- Horizontal gallery ---- */
    .gallery {
      display: flex;
      flex-wrap: nowrap;
      overflow-x: auto;
      gap: 12px;
      padding: 10px;
      scroll-snap-type: x proximity;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
    }
    .gallery::-webkit-scrollbar { display: none; }

    .gallery img {
      flex: 0 0 auto;
      height: 260px;
      width: auto;
      border-radius: 6px;
      transition: transform 0.25s ease-in-out;
      scroll-snap-align: center;
      cursor: pointer;
      background: #111;
    }
    .gallery img:hover { transform: scale(1.04); }

    @media (max-width: 600px) {
      .gallery img { height: 200px; }
    }

    /* ---- Scroll buttons ---- */
    .scroll-btn {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      height: 40px;
      width: 40px;
      border-radius: 999px;
      border: 1px solid var(--glass-border);
      background: var(--glass);
      color: #fff;
      backdrop-filter: blur(4px);
      cursor: pointer;
      z-index: 6;
      display: grid;
      place-items: center;
      opacity: 0.85;
      transition: opacity .15s ease, background .15s ease, transform .1s ease;
    }
    .scroll-btn:hover { opacity: 1; background: rgba(255,255,255,0.15); }
    .scroll-btn:active { transform: translateY(-50%) scale(0.98); }
    .scroll-btn.left  { left: 8px; }
    .scroll-btn.right { right: 8px; }
    .gallery-wrap.at-start .scroll-btn.left { display: none; }
    .gallery-wrap.at-end   .scroll-btn.right { display: none; }

    /* ---- Lightbox overlay ---- */
    #lightbox {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.9);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 2000;
    }
    #lightbox.show { display: flex; }

    #lightbox img {
      max-width: 90%;
      max-height: 90%;
      border-radius: 6px;
      box-shadow: 0 0 30px rgba(0,0,0,0.6);
      transition: opacity .2s ease;
    }

    /* Lightbox arrows */
    .lb-arrow {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      color: white;
      font-size: 2.5rem;
      cursor: pointer;
      user-select: none;
      z-index: 2100;
      padding: 0 15px;
      transition: opacity 0.2s ease;
      opacity: 0.85;
    }
    .lb-arrow:hover { opacity: 1; }
    .lb-arrow.left { left: 10px; }
    .lb-arrow.right { right: 10px; }

    /* Lightbox close "X" */
    #lightbox .lb-close {
      position: absolute;
      top: 12px;
      right: 18px;
      font-size: 1.8rem;
      color: white;
      opacity: 0.8;
      cursor: pointer;
      user-select: none;
      z-index: 2100;
    }
    #lightbox .lb-close:hover { opacity: 1; }
  </style>
</head>
<body>
  <h1>Pablo Biedma</h1>

  <div class="gallery-wrap at-start">
    <button class="scroll-btn left" aria-label="Scroll left">❮</button>
    <div class="gallery" id="gallery"></div>
    <button class="scroll-btn right" aria-label="Scroll right">❯</button>
  </div>

  <!-- Lightbox -->
  <div id="lightbox" aria-modal="true" role="dialog">
    <span class="lb-arrow left" aria-label="Previous">❮</span>
    <img alt="" />
    <span class="lb-arrow right" aria-label="Next">❯</span>
    <span class="lb-close" aria-label="Close">✕</span>
  </div>

  <script>
    const repoUrl = "https://api.github.com/repos/pablobiedma/pablobiedma.github.io/contents/model_pics";
    const wrap = document.querySelector('.gallery-wrap');
    const scroller = document.getElementById('gallery');
    const btnLeft = wrap.querySelector('.scroll-btn.left');
    const btnRight = wrap.querySelector('.scroll-btn.right');

    const lightbox = document.getElementById('lightbox');
    const lightImg = lightbox.querySelector('img');
    const lbPrev = lightbox.querySelector('.lb-arrow.left');
    const lbNext = lightbox.querySelector('.lb-arrow.right');
    const lbClose = lightbox.querySelector('.lb-close');

    let images = [];
    let currentIndex = 0;

    // Load images (random order)
    fetch(repoUrl)
      .then(r => r.json())
      .then(data => {
        data = data
          .filter(f => /\.(jpe?g|png|webp)$/i.test(f.name))
          .sort(() => Math.random() - 0.5);

        images = data.map(f => f.download_url);

        images.forEach(src => {
          const img = document.createElement("img");
          img.src = src;
          img.loading = "lazy";
          img.decoding = "async";
          scroller.appendChild(img);
        });

        setTimeout(updateShadows, 400);
      })
      .catch(err => console.error("Error fetching images:", err));

    /* ---------- Horizontal scroll helpers ---------- */
    function scrollByAmount(dx) {
      scroller.scrollBy({ left: dx, behavior: 'smooth' });
    }

    function updateShadows() {
      const atStart = scroller.scrollLeft <= 1;
      const atEnd = Math.ceil(scroller.scrollLeft + scroller.clientWidth) >= scroller.scrollWidth - 1;

      wrap.classList.toggle('at-start', atStart);
      wrap.classList.toggle('at-end', atEnd);
      wrap.classList.toggle('at-middle', !atStart && !atEnd);
    }

    btnLeft.addEventListener('click', () => scrollByAmount(-Math.max(300, scroller.clientWidth * 0.8)));
    btnRight.addEventListener('click', () => scrollByAmount(+Math.max(300, scroller.clientWidth * 0.8)));

    scroller.addEventListener('scroll', updateShadows, { passive: true });
    window.addEventListener('resize', updateShadows);

    /* ---------- Lightbox logic ---------- */
    function showImage() {
      lightImg.style.opacity = '0';
      const src = images[currentIndex];
      if (!src) return;
      const tmp = new Image();
      tmp.onload = () => {
        lightImg.src = src;
        lightImg.style.opacity = '1';
      };
      tmp.src = src;
    }

    function openLightboxFromSrc(src) {
      currentIndex = images.indexOf(src);
      if (currentIndex === -1) return;
      showImage();
      lightbox.classList.add('show');
    }

    function closeLightbox() {
      lightbox.classList.remove('show');
    }

    function nextImage() {
      currentIndex = (currentIndex + 1) % images.length;
      showImage();
    }

    function prevImage() {
      currentIndex = (currentIndex - 1 + images.length) % images.length;
      showImage();
    }

    // Open on click
    scroller.addEventListener('click', e => {
      if (e.target.tagName === 'IMG') {
        openLightboxFromSrc(e.target.src);
      }
    });

    // Lightbox controls
    lbNext.addEventListener('click', e => { e.stopPropagation(); nextImage(); });
    lbPrev.addEventListener('click', e => { e.stopPropagation(); prevImage(); });
    lbClose.addEventListener('click', e => { e.stopPropagation(); closeLightbox(); });

    // Click outside image to close
    lightbox.addEventListener('click', e => {
      if (e.target === lightbox) closeLightbox();
    });

    // Keyboard navigation
    window.addEventListener('keydown', e => {
      if (!lightbox.classList.contains('show')) return;
      if (e.key === 'ArrowRight') nextImage();
      else if (e.key === 'ArrowLeft') prevImage();
      else if (e.key === 'Escape') closeLightbox();
    });
  </script>
</body>
</html>
